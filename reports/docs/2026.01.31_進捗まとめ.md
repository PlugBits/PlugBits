# Labelテンプレ実装まとめ（2026-01）

## ゴール
- Card形式は廃止
- Label形式に一本化
- レコード単位運用
- QR必須、最大5フィールド
- ラベルサイズはユーザーがmm単位で調整
- 印刷枚数はレコードのフィールド指定（copies）

---

## 決定した仕様（確定）

### ラベル基本仕様
- structureType: label_v1
- レコード単位で1ラベル定義
- 印刷枚数は「copies フィールド」で指定
  - 未指定 / 空 / 0 → 1枚
  - 上限 1000
- QRコードは必須
  - 内容はユーザーが任意フィールドを指定
- 任意項目は最大5フィールド
- CardタイプはUIから完全に非表示（既存レンダーフローは保持）

---

## UI仕様（現状）

### 設定項目
- 用紙プリセット（Letter / A4 / Custom）
- 用紙幅・高さ（mm）
- 列 / 行
- 余白（mm）
- 間隔（mm）
- X/Y補正（mm）
- 面付けプレビュー（簡易）
- 校正PDF（位置合わせ用）

### 問題点（UI）
- 「列 / 行」を変更しても
  - 校正PDF
  - PDFプレビュー
  に反映されていないように見える
- 面付けプレビューが下で見切れる
  - 原因: container に `overflow: hidden`
  - → scroll に変更して解消済み
- 「列」「行」という日本語表記はOK（col/row廃止）

---

## 技術的な現状

### テンプレート
- dev-templates に以下は存在
  - label_standard_v1.json
  - label_compact_v1.json
  - label_logistics_v1.json
- PUT /templates/xxx は 400 → schema / mapping 不整合あり

### copies 問題（重要）
- UIで copies フィールドを指定
- Kintone レコードに「3」を入力
- しかし PDFは常に1枚

#### 調査結果
```bash
jq '.mapping.copiesFieldCode'
